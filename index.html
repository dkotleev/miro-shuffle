<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Miro Shuffle Z</title>
  <script src="https://miro.com/app/static/sdk/v2/miro.js"></script>
</head>
<body>
  <h3>Перемешать элементы на доске</h3>
  <button id="shuffle">Shuffle Layers</button>

  <script>
    async function shuffleLayers() {
      try {
        const items = await miro.board.get({
          type: ['shape', 'sticky_note', 'text', 'image']
        });

        if (items.length === 0) {
          alert('На доске нет объектов для перемешивания!');
          return;
        }

        for (const item of items) {
          if (Math.random() > 0.5) {
            await item.bringToFront();
          } else {
            await item.sendToBack();
          }
        }

        alert('Готово! Элементы перемешаны.');
      } catch (err) {
        console.error(err);
        alert('Ошибка при доступе к доске. Откройте страницу внутри Miro.');
      }
    }

    document.getElementById('shuffle').onclick = shuffleLayers;

    // Если страница открыта внутри Miro, можно сразу открыть её в модальном окне
    miro.board.ui.init(() => {
      // Здесь можно открыть текущую страницу в modal/iframe, если нужно
      // miro.board.ui.openModal('https://dkotleev.github.io/miro-shuffle/', {width:600, height:400});
    });
  </script>
</body>
</html>
